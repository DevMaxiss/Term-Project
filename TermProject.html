<!DOCTYPE html>
<html>
<head>
<meta charset=utf-8>
<title>Term Project</title>
</head>

<style>
body.background{
background-attachment: fixed;
background-image: url("LLBG2.jpg");
background-repeat: no-repeat;
background-size: 100%;
}

canvas.environment{
border: 3px black solid;
background-color: #ffffff;  
}

div.canvasContainer{
text-align: center;
}

div.header{
text-align: center;
border:5px #000000 solid;
background-color:#ffffff; /*Different Colour? Maybe an image for banner?*/
background-size:100%;


}

button.reset{
/*Possible button style*/
}
</style>


<body class = "background">

<div class = "header"> <!--Header/Banner.-->
<h1>CPSC1045 Term Project </h1>
<p>Developed by Jerry Fung & Bradley Wong <br>Section 002</p>

</div>

<hr>

<div class = "canvasContainer"> <!--Where the game will be located.-->

<canvas id = "pingPong"class = "environment" width = 1000 height = 700>
Canvas not supported on this browser.
</canvas>
<br>
<button type = "button">Reset Game</button>
<button type = "button">Reset Scores</button>

</div>

<script src="ball.js"></script>
<script>

var canvas = document.getElementById("pingPong");
var ctx = canvas.getContext("2d");

var imgH = 200, imgW = 150; //Player1 character properties.
var x = 0, y = canvas.height/2-imgH/2; //Starting positions.
var x2 = canvas.width-imgW, y2 = canvas.height/2-imgH/2;
var speed = 24; //Speed at which the paddles move.

var img = document.createElement("img");
img.src = "test1.jpg";

var img2 = document.createElement("img");
img2.src = "emilia.jpg";

var keys = [];


window.onload = function(){
ctx.drawImage(img,x,y,imgW,imgH);
ctx.drawImage(img2,x2,y,imgW,imgH);
function moveSet(){
	if (keys[87] && y >= 0) {//up
		ctx.clearRect(x,y-speed,imgW,canvas.height);
		y-=speed;
		ctx.drawImage(img,x,y,imgW,imgH);
	}
	if (keys[83] && y <= canvas.height-imgH) {//down
		ctx.clearRect(x,y-speed,imgW,canvas.height);
		y+=speed;
		ctx.drawImage(img,x,y,imgW,imgH);
	}
	if (keys[38] && y2 >= 0) {//up
		ctx.clearRect(x2,y2-speed,imgW,canvas.height);
		y2-=speed;
		ctx.drawImage(img2,x2,y2,imgW,imgH);
	}
	if (keys[40] && y2 <= canvas.height-imgH) { //down
		ctx.clearRect(x2,y2-speed,imgW,canvas.height);
		y2+=speed;
		ctx.drawImage(img2,x2,y2,imgW,imgH);
	}
}


document.body.addEventListener("keydown", function(key){ //movement.
	keys[key.keyCode] = true;
	moveSet();
});

document.body.addEventListener("keyup", function(key){ //movement.
	keys[key.keyCode] = false;	
	moveSet();
});
    
        var width = 1000;
        var height = 700;
        var canvas = ctx = false;
        var frameRate = 1/40; // Seconds
        var frameDelay = frameRate * 1000; // ms
        var loopTimer = false;
        
        var ball = {
            position: {x: width/2, y: height/2},
            velocity: {x: 5, y: 0},
            mass: 0, //kg
            radius: 15, // 1px = 1cm
            restitution: -1
            };
        var setup = function() {
          canvas = document.getElementById("pingPong");
          ctx = canvas.getContext("2d");
          
          ctx.fillstyle = "purple";
          loopTimer = setInterval(loop,frameDelay);
        }
        
        var loop = function() {
            
            // Integrate to get velocity
            //ball.velocity.x += ax*frameRate;
            //ball.velocity.y += ay*frameRate;

            // Integrate to get position
            ball.position.x += ball.velocity.x*frameRate*100;
            ball.position.y += ball.velocity.y*frameRate*100;
        
            // Handle collisions
        if (ball.position.y > height - ball.radius) { //BOTTOM
            ball.velocity.y *= ball.restitution;
            ball.position.y = height - ball.radius;
        }
        if (ball.position.y < ball.radius) {            //TOP
            ball.velocity.y *= ball.restitution;
            ball.position.y = ball.radius;
        }
        if (ball.position.x > width - ball.radius) {        //RIGHT
            ball.velocity.x *= ball.restitution;
            ball.position.x = width - ball.radius;
        }
        if ((ball.position.x < ball.radius) || (ball.position.x < imgW+ball.radius)&& (ball.position.y > y && ball.position.y < y+imgH)) {        //LEFT
            ball.velocity.x *= ball.restitution;
            if ((ball.position.x < imgW+ball.radius)&& (ball.position.y > y && ball.position.y < y+imgH)) {
                ball.position.x = imgW+ball.radius;
            }
            else {
                ball.position.x = ball.radius;
            }
            
        }
        
        // Draw the ball
        //ctx.clearRect(ball.position.x, ball.position.y,ball.radius,ball.radius);
        //ctx.clearRect(imgW,0,width-imgW,height);
        ctx.clearRect(0,0,width,height);
        ctx.fillRect(x,y,imgW+1,imgH-1);
        ctx.drawImage(img,x,y,imgW,imgH);
        ctx.fillRect(x2,y2,imgW-1,imgH);
        ctx.drawImage(img2,x2,y2,imgW,imgH);
            
        ctx.save();

        ctx.translate(ball.position.x, ball.position.y);
        ctx.beginPath();
        ctx.arc(0, 0, ball.radius, 0, Math.PI*2, true);
        ctx.fill();
        ctx.closePath();

        ctx.restore();
        }
        
        setup();

}
//tempBall
/*
ctx.moveTo(canvas.width/2, canvas.height/2);
ctx.fillStyle = "purple";
ctx.arc(canvas.width/2, canvas.height/2,10,0,Math.PI*2);
ctx.fill();
*/

//Boundaries of the canvas
    var leftBound=0, rightBound=canvas.width, upBound=0, downBound=canvas.height;

</script>

</body>
</html>
